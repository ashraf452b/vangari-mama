{% extends "base.html" %}

{% block title %}{{ post.trash_type.title() }}{% endblock %}

{% block content %}
<div class="container">
    <div class="post-details-grid">
        <div class="post-info-card">
            <h1 class="post-title">{{ post.trash_type.title() }}</h1>
            <p class="posted-by">Posted by: {{ post.owner.username }}</p>
            
            <div class="info-section">
                <h3>Details</h3>
                <p>{{ post.description }}</p>
            </div>

            <div class="info-section">
                <h3>Contact & Location</h3>
                <p><i class="fas fa-phone-alt fa-fw"></i> {{ post.phone_number }}</p>
                <p><i class="fas fa-map-marker-alt fa-fw"></i> {{ post.location }}</p>
                {% if post.google_map_link %}
                <p><i class="fas fa-map fa-fw"></i> <a href="{{ post.google_map_link }}" target="_blank">View on Google Maps</a></p>
                {% endif %}
            </div>

            <div class="info-section">
                <h3>Pricing</h3>
                <p>Initial Quantity: {{ post.quantity }} (Kg or Pieces)</p>
                <p class="asking-price">Asking Price: à§³{{ post.price }}</p>
                <p>Negotiable: {{ 'Yes' if post.is_negotiable else 'No' }}</p>
            </div>
        </div>

        <div class="transaction-card">
            <h3>Complete Purchase</h3>
            <p>After agreeing with the seller, enter the final weight and price to complete the transaction.</p>
            
            <form method="POST" action="{{ url_for('complete_transaction', post_id=post.id) }}" class="transaction-form">
                <div class="form-group">
                    <label for="final_weight" class="form-label">Final Weight (in Kg)</label>
                    <input type="number" step="0.01" name="final_weight" class="form-control" placeholder="e.g., 10.5" required>
                </div>
                <div class="form-group">
                    <label for="final_price" class="form-label">Final Price (Negotiated)</label>
                    <input type="number" step="0.01" name="final_price" class="form-control" placeholder="e.g., 45.50" required>
                </div>
                <button type="submit" class="form-btn">Accept & Complete Purchase</button>
            </form>
        </div>
    </div>
</div>
{% endblock %}